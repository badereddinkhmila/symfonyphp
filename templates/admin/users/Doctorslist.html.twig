{% extends "partials/_sideNav2.html.twig" %}
{%  block style %}
{% endblock %}
{% block main %}
    {% for labels , message in app.flashes %}
        <div role="alert" class="alert alert-{{labels}} alert-dismissible">
            <button aria-labels="Close" data-dismiss="alert" class="close" type="button"><span aria-hidden="true">×</span></button>
            <h2 class="alert-heading">Succès!</h2>
            <hr>
            {% for msg in message %}
                <p> <i class="fas fa-user-md"></i> {{ msg | raw }} </p>
            {% endfor %}
        </div>
    {% endfor %}
    <div class="container-fluid">
        <div class="card-header text-capitalize bg-1-lightpink shadow-lg row">
            <span class="col-10"><h5>Liste des docteurs</h5></span>
            <span class="col-2"><button data-target="#add_doctor" data-toggle="modal" class="btn btn-md bg-2-dark text-light" type="button"><i class="fa fa-plus-circle"></i>  <span>Ajouter</span></button></span>
        </div>
        <br>
        <div class="bg-white d-flex mt-3 container">
            <img src="/images/spinner.svg" id="loader" class="float-center">
            <table id="datatable" class="table table-striped table-bordered table-light row-border compact display m-3 hover">
                <thead>
                <tr>
                    <th scope="col">Prénom</th>
                    <th scope="col">Nom</th>
                    <th scope="col">Avatar</th>
                    <th scope="col">Email</th>
                    <th scope="col"></th>
                </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
    </div>
    {% include "partials/_modal.html.twig" with {form:form , modalID:"add_doctor",User:"Docteur"} %}
{% endblock %}
{% block javascript %}
<script src="/js/Datatable.js"></script>
<script src="/js/Datatables.bootstrap.js"></script>
<script type="text/javascript">
    $(document).ready(function(){
    $("#datatable").hide();
    $("#loader").show();
    $.ajax({
    url:"/admin/json/doctors",
    method:"GET",
    dataType:"json",
    async:true,
    success:function(data){
    console.log(data);
    $('#datatable').DataTable({
    "pagingType": "full_numbers",
    "language": {
    "url": "//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/French.json"
},
    data:data,
    columns:[
{'data':'firstname'},
{'data':'lastname'},
{"render": function (data, type, JsonResultRow, meta) {
    return '<img class="avatar avatar-small" src="'+JsonResultRow.avatar+'">';
}},
{'data':'email'},
{"render":function(data,type,JsonResultRow,meta){
    return '<button class="btn btn-sm btn-outline-danger m-1 delete" id="'+JsonResultRow.id+'"><i class="fas fa-trash"></i></button><a href="/dashboard/patient/'+JsonResultRow.id+'" class="btn btn-sm btn-outline-info m-1"><i class="fas fa-id-card-alt"></i></a><a href="/dashboard/patients/'+JsonResultRow.id+'/data" class="btn btn-sm btn-outline-primary m-1"><i class="fas fa-chart-line"></i></a>'
}
}

    ],

})
}
}).done(function(){
    $("#loader").hide();
    $("#datatable").show();
});
});
    var user_id;
    $(document).on('click','.delete',function(){
    user_id=$(this).attr('id');
    $('#confirmModal').modal('show');
    $('#formdel').attr("action","/dashboard/patients/"+user_id+"/delete");
});
    /*$(document).on('click','#newpat',function(){
    $('#add_patient').modal('show');
    });*/
</script>
{% endblock %}
